<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xeet.ai Crypto Influencers Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gray: {
                            800: '#1f2937',
                            900: '#111827'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-900 text-gray-200 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold text-center mb-8 text-indigo-400">Xeet.ai Crypto Influencers Dashboard</h1>
        
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
            <div class="lg:col-span-1">
                <div class="bg-gray-800 rounded-lg p-6 shadow-lg">
                    <h2 class="text-xl font-semibold mb-6" id="filters-title">–§–∏–ª—å—Ç—Ä—ã (0)</h2>
                    
                    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ —Ñ–∞–π–ª–∞ -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">–ó–∞–≥—Ä—É–∑–∏—Ç—å CSV —Ñ–∞–π–ª</label>
                        <input type="file" id="file-input" accept=".csv" class="w-full p-2 bg-gray-700 border border-gray-600 rounded text-sm">
                    </div>
                    
                    <!-- –ü–æ–∏—Å–∫ -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">–ü–æ–∏—Å–∫ –ø–æ username</label>
                        <input type="text" id="search-input" placeholder="–í–≤–µ–¥–∏—Ç–µ username..." class="w-full p-2 bg-gray-700 border border-gray-600 rounded text-sm">
                    </div>
                    
                    <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button id="sort-score" class="sort-btn bg-indigo-600 text-white px-3 py-2 rounded text-sm font-medium">
                                Score ‚ñº
                            </button>
                            <button id="sort-followers" class="sort-btn bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded text-sm font-medium">
                                Followers
                            </button>
                            <button id="sort-signal" class="sort-btn bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded text-sm font-medium">
                                Signal
                            </button>
                            <button id="sort-noise" class="sort-btn bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded text-sm font-medium">
                                Noise
                            </button>
                        </div>
                    </div>
                    
                    <!-- –§–∏–ª—å—Ç—Ä –ø–æ Score -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">–§–∏–ª—å—Ç—Ä –ø–æ Score</label>
                        <div class="grid grid-cols-2 gap-2">
                            <input type="number" id="score-min" placeholder="–ú–∏–Ω" class="p-2 bg-gray-700 border border-gray-600 rounded text-sm">
                            <input type="number" id="score-max" placeholder="–ú–∞–∫—Å" class="p-2 bg-gray-700 border border-gray-600 rounded text-sm">
                        </div>
                    </div>
                    
                    <!-- –§–∏–ª—å—Ç—Ä –ø–æ Noise Points -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">–§–∏–ª—å—Ç—Ä –ø–æ Noise Points</label>
                        <div class="grid grid-cols-2 gap-2">
                            <input type="number" id="noise-min" placeholder="–ú–∏–Ω" class="p-2 bg-gray-700 border border-gray-600 rounded text-sm">
                            <input type="number" id="noise-max" placeholder="–ú–∞–∫—Å" class="p-2 bg-gray-700 border border-gray-600 rounded text-sm">
                        </div>
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ -->
                    <button id="reset-filters" class="w-full bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded font-medium">
                        –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                    </button>
                </div>
            </div>
            
            <!-- –°–µ—Ç–∫–∞ –≥–µ—Ä–æ–µ–≤ -->
            <div class="lg:col-span-3">
                <div id="heroes-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6">
                    <div class="text-center text-gray-400 py-12">
                        –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ CSV —Ñ–∞–π–ª
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let allHeroes = [];
        let displayedHeroes = [];
        let currentSort = { key: 'score', order: 'desc' };

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const fileInput = document.getElementById('file-input');
        const searchInput = document.getElementById('search-input');
        const scoreMinInput = document.getElementById('score-min');
        const scoreMaxInput = document.getElementById('score-max');
        const noiseMinInput = document.getElementById('noise-min');
        const noiseMaxInput = document.getElementById('noise-max');
        const resetButton = document.getElementById('reset-filters');
        const heroesGrid = document.getElementById('heroes-grid');
        const filtersTitle = document.getElementById('filters-title');
        const sortButtons = {
            'score': document.getElementById('sort-score'),
            'followerCount': document.getElementById('sort-followers'),
            'signalScore': document.getElementById('sort-signal'),
            'noisePoints': document.getElementById('sort-noise')
        };

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
        fileInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                Papa.parse(file, {
                    header: true,
                    complete: function(results) {
                        allHeroes = results.data.map(hero => ({
                            ...hero,
                            rank: parseInt(hero.rank),
                            followerCount: parseInt(hero.followerCount),
                            score: parseFloat(hero.score),
                            signalScore: parseFloat(hero.signalScore),
                            noisePoints: parseFloat(hero.noisePoints),
                            totalEngagement: parseInt(hero.totalEngagement),
                            engagementRate: parseFloat(hero.engagementRate),
                            averageEngagementPerPost: parseFloat(hero.averageEngagementPerPost)
                        })).filter(hero => hero.username); // –£–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
                        
                        applyFiltersAndSort();
                    },
                    error: function(error) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ CSV:', error);
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞');
                    }
                });
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
        searchInput.addEventListener('input', applyFiltersAndSort);
        scoreMinInput.addEventListener('input', applyFiltersAndSort);
        scoreMaxInput.addEventListener('input', applyFiltersAndSort);
        noiseMinInput.addEventListener('input', applyFiltersAndSort);
        noiseMaxInput.addEventListener('input', applyFiltersAndSort);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        Object.keys(sortButtons).forEach(key => {
            sortButtons[key].addEventListener('click', () => {
                if (currentSort.key === key) {
                    currentSort.order = currentSort.order === 'asc' ? 'desc' : 'asc';
                } else {
                    currentSort.key = key;
                    currentSort.order = 'desc';
                }
                updateSortButtons();
                applyFiltersAndSort();
            });
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–±—Ä–æ—Å–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        resetButton.addEventListener('click', () => {
            searchInput.value = '';
            scoreMinInput.value = '';
            scoreMaxInput.value = '';
            noiseMinInput.value = '';
            noiseMaxInput.value = '';
            currentSort = { key: 'score', order: 'desc' };
            updateSortButtons();
            applyFiltersAndSort();
        });

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        function applyFiltersAndSort() {
            if (allHeroes.length === 0) return;

            let filtered = [...allHeroes];

            // –§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–∏—Å–∫—É
            const searchTerm = searchInput.value.toLowerCase();
            if (searchTerm) {
                filtered = filtered.filter(hero => 
                    hero.username.toLowerCase().includes(searchTerm)
                );
            }

            // –§–∏–ª—å—Ç—Ä –ø–æ Score
            const scoreMin = scoreMinInput.value ? parseFloat(scoreMinInput.value) : null;
            const scoreMax = scoreMaxInput.value ? parseFloat(scoreMaxInput.value) : null;
            
            if (scoreMin !== null) {
                filtered = filtered.filter(hero => hero.score >= scoreMin);
            }
            if (scoreMax !== null) {
                filtered = filtered.filter(hero => hero.score <= scoreMax);
            }

            // –§–∏–ª—å—Ç—Ä –ø–æ Noise Points
            const noiseMin = noiseMinInput.value ? parseFloat(noiseMinInput.value) : null;
            const noiseMax = noiseMaxInput.value ? parseFloat(noiseMaxInput.value) : null;
            
            if (noiseMin !== null) {
                filtered = filtered.filter(hero => hero.noisePoints >= noiseMin);
            }
            if (noiseMax !== null) {
                filtered = filtered.filter(hero => hero.noisePoints <= noiseMax);
            }

            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
            filtered.sort((a, b) => {
                const aValue = a[currentSort.key];
                const bValue = b[currentSort.key];
                
                if (currentSort.order === 'asc') {
                    return aValue - bValue;
                } else {
                    return bValue - aValue;
                }
            });

            displayedHeroes = filtered;
            renderHeroes();
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        function updateSortButtons() {
            Object.keys(sortButtons).forEach(key => {
                const button = sortButtons[key];
                if (key === currentSort.key) {
                    button.className = 'sort-btn bg-indigo-600 text-white px-3 py-2 rounded text-sm font-medium';
                    const arrow = currentSort.order === 'asc' ? ' ‚ñ≤' : ' ‚ñº';
                    button.textContent = getSortButtonText(key) + arrow;
                } else {
                    button.className = 'sort-btn bg-gray-700 hover:bg-gray-600 px-3 py-2 rounded text-sm font-medium';
                    button.textContent = getSortButtonText(key);
                }
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∫–Ω–æ–ø–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        function getSortButtonText(key) {
            const texts = {
                'score': 'Score',
                'followerCount': 'Followers',
                'signalScore': 'Signal',
                'noisePoints': 'Noise'
            };
            return texts[key] || key;
        }

        // –§—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –≥–µ—Ä–æ–µ–≤
        function renderHeroes() {
            filtersTitle.textContent = `–§–∏–ª—å—Ç—Ä—ã (${displayedHeroes.length})`;
            
            if (allHeroes.length === 0) {
                heroesGrid.innerHTML = '<div class="text-center text-gray-400 py-12">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ CSV —Ñ–∞–π–ª</div>';
                return;
            }

            if (displayedHeroes.length === 0) {
                heroesGrid.innerHTML = '<div class="text-center text-gray-400 py-12">–ì–µ—Ä–æ–∏ —Å —Ç–∞–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            heroesGrid.innerHTML = displayedHeroes.map(hero => `
                <div class="bg-gray-800 rounded-lg p-4 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1">
                    <div class="text-center mb-4">
                        <div class="w-16 h-16 mx-auto mb-3 bg-gray-700 rounded-full flex items-center justify-center">
                            <span class="text-2xl">üë§</span>
                        </div>
                        <h3 class="font-bold text-lg text-white">${hero.username}</h3>
                        <div class="text-indigo-400 text-xl font-bold mt-2">${hero.score.toFixed(2)}</div>
                    </div>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div class="flex justify-between">
                            <span>Signal Score:</span>
                            <span class="text-green-400">${hero.signalScore.toFixed(2)}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Noise Points:</span>
                            <span class="text-red-400">${hero.noisePoints.toFixed(2)}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Followers:</span>
                            <span class="text-blue-400">${hero.followerCount.toLocaleString()}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Rank:</span>
                            <span class="text-yellow-400">#${hero.rank}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateSortButtons();
    </script>
</body>
</html>
